<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
</head>
<body>
<p><strong>github.ioのサーバー時刻:</strong> <span id="server"></span></p>
<p><strong>端末の時刻:</strong> <span id="client"></span></p>
<p><strong>時差:</strong> <span id="dif"></span></p>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script>
getServerDate(makeHTML);
var clientDate = new Date();
$("#client").html(clientDate.getHours() + ':' + clientDate.getMinutes() + ':' + clientDate.getSeconds() + '.' + clientDate.getMilliseconds());
function getServerDate(callback){
	$.ajax({
		type : 'HEAD',
		url :  window.location.href,
		cache : false
	}).done(function(data, textStatus, xhr) {
		try {
			var xTimer = xhr.getResponseHeader("X-Timer"); // 'S1602674787.604632,VS0,VE180'
			xTimer = parseFloat(xTimer.split(',')[0].replace(/[^0-9|.]/g,'')); // 1602674787.604632
			var milli = parseFloat('0.' + String(xTimer).split('.')[1] || 0); // 0.604632
			if (milli >= 0.5) {
				xTimer -= 1; // 1602674786.604632
			}
			xTimer = xTimer * 1000; // 1602674786604.632
			var result = new Date(xTimer);
			result = result.getHours() + ':' + result.getMinutes() + ':' + result.getSeconds() + '.' + result.getMilliseconds();
			var dif = clientDate.getTime() - xTimer;
			var str;
			if (dif > 0) {
				str = 'あなたの端末は ' + Math.abs((dif / 1000)).toFixed(3) + ' 秒<b>進んで</b>います。';
			} else {
				str = 'あなたの端末は ' + Math.abs((dif / 1000)).toFixed(3) + ' 秒<b>遅れて</b>います。';
			}
			$("#dif").html(str);
		} catch(e) {
			var result = new Date();
			result = result.getHours() + ':' + result.getMinutes() + ':' + result.getSeconds() + '.' + result.getMilliseconds();
		}
		callback(result);
	}).fail(function() {
		var result = new Date();
		result = result.getHours() + ':' + result.getMinutes() + ':' + result.getSeconds() + '.' + result.getMilliseconds();
		callback(result);
	});
}

function makeHTML(result){
	$("#server").html(result);
}

</script>
</body>
</html>